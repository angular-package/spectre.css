// Sass.
@use 'sass:list';
@use 'sass:map';

// Variables.
@use '../../../variables' as *;

// Functions.
@use '../get-var-alpha.function' as *;
@use 'get-var-hue.function' as *;
@use 'get-var-lightness.function' as *;
@use 'get-var-saturation.function' as *;

// The function `get-hsla-color()` returns the `hsla()` color from a CSS variables of the given `$name`.
// The `$name` parameter can be passed as two-index list, where the second item is the `$lightness`,
// or can be passed as three-index list, where the third item is the `$alpha`.
// ('primary', -35.5%, 0.95);
// ('primary-dark', ('lightness': -35.5%, 'alpha': 0.95));
@function get-hsla-color(
  $name,
  $hue: 0deg,
  $saturation: 0%,
  $lightness: 0%,
  $alpha: 1,
  $prefix: $var-prefix
) {
  @if list.length($name) > 1 {
    @if list.length($name) == 3 {
      $alpha: list.nth($name, 3);
    }
    // If second argument is the map.
    @if type-of(list.nth($name, 2)) == 'map' {
      @if map.has-key(list.nth($name, 2), 'alpha') {
        $alpha: map.get(list.nth($name, 2), 'alpha');
      }
      @if map.has-key(list.nth($name, 2), 'lightness') {
        $lightness: $lightness + map.get(list.nth($name, 2), 'lightness');
      }
    } @else {
      $lightness: $lightness + list.nth($name, 2);
    }
    $name: list.nth($name, 1);
  }
  @return hsla(
    calc(#{get-var-hue($name, $prefix)} + #{$hue}),
    calc(#{get-var-saturation($name, $prefix)} + #{$saturation}),
    calc(#{get-var-lightness($name, $prefix)} + #{$lightness}),
    calc(#{get-var-alpha($name, $prefix)} * #{$alpha})
  );
}
